javascript:(()=>{function e(e,t){const n=document.createElement(t);return n.className="content-enhancer",n.innerHTML=e,n}const t=document.head,n=e("body{margin: 0;background-color: black}img, video{display: block;width: 100%}video{margin-top: 100px;margin-bottom: 100px}.loading{background-color: hsl(30, 75%, 50%)}.loaded{background-color: hsl(120, 75%, 50%)}.clicked{opacity: 0.5}.hide{display: none}.show{display: block}.go-video-l1{width: 100%;height: 100vh;background-color: hsl(0, 50%, 25%)}.go-back{height: 30%;width: 30%;position: fixed;top: 0;left: 0}.go-back:active{background-color: rgba(0, 0, 0, 0.5)}.load-more, .refresh{background-color: rgba(0, 0, 0, 0.5);margin-top: 200px;margin-bottom: 200px;font-size: 2rem;line-height: 3;text-align: center}","style");t.appendChild(n);const o=e('async function loadL1(){if(""!==nextSearchResultsHref){const e=document.getElementById(L1_CONTAINER_ID),t=await getResponseDocument(nextSearchResultsHref),s=getSearchResultsThumbnails(t);setNextSearchResultsHref(t),await loadThumbnail(s,e)}}',"script");t.appendChild(o);const a=e('let level1ScrollPosition;async function loadL2(e){originalHref.includes(TOKYOMOTION)||originalHref.includes(KISSJAV)?await loadVideo(e):originalHref.includes(NHENTAI)?await loadGalleryThumbnails(e):originalHref.includes(ASURASCANS)&&await loadChapters(e)}function goToL1(e){document.getElementById(L1_CONTAINER_ID).className="show",document.getElementById(e).remove(),window.scrollTo({top:level1ScrollPosition})}async function loadVideo(e){const t=e.getAttribute("data-href"),o="l2"+t,a="bg"+t,l="loaded"===e.getAttribute("data-load-status"),n="loading"===e.getAttribute("data-load-status");if(l){level1ScrollPosition=window.scrollY,window.scrollTo({top:0}),e.removeAttribute("data-load-status");const t=document.getElementById(a);t.after(e),t.remove(),document.getElementById(L1_CONTAINER_ID).className="hide",document.getElementById(o).className="show"}else if(n);else{const l=document.createElement("div");e.setAttribute("data-load-status","loading"),l.id=a,l.className="loading",e.after(l),e.className="clicked",l.appendChild(e);const n=document.createElement("div");n.id=o,n.className="hide",document.body.appendChild(n);const d=document.createElement("video");d.controls=!0,d.preload="auto",d.playsInline=!0,d.muted=!0,d.onloadedmetadata=async()=>{d.onloadedmetadata=null,await waitFor(100),await d.play(),await waitFor(100),d.pause(),e.setAttribute("data-load-status","loaded"),l.className="loaded"},d.onerror=async()=>{await waitFor(5e3),d.load()};const i=document.createElement("source"),c=await getResponseDocument(t);let s;t.includes(TOKYOMOTION)?s=c.getElementById("vjsplayer"):t.includes(KISSJAV)&&(s=c.getElementById("player-fluid"));const r=s.querySelectorAll("source");let u=null;for(const e of r)(originalHref.includes(TOKYOMOTION)&&e.src.includes("/hd/")||originalHref.includes(KISSJAV)&&e.src.includes("720p"))&&(u=e.src);null===u&&(u=r[0].src),i.src=u,d.appendChild(i),n.appendChild(d);const m=document.createElement("div");m.className="go-video-l1",m.setAttribute("onclick",\'goToL1("\'+o+\'")\'),n.appendChild(m);const g=document.createElement("button");g.className="refresh",g.type="button",g.onclick=()=>{s.scrollIntoView(),d.load()},g.innerText="Reload the video",n.appendChild(g)}}function createGoToL1(e,t){const o=document.createElement("div");o.className="go-back",o.setAttribute("onclick",t+"(\'"+e.id+"\')"),e.appendChild(o)}async function loadGalleryThumbnails(e){level1ScrollPosition=window.scrollY,window.scrollTo({top:0});const t=e.getAttribute("data-href"),o="l2"+t,a=document.createElement("div");a.id=o,document.body.appendChild(a),document.getElementById(L1_CONTAINER_ID).className="hide",createGoToL1(a,"goToL1");const l=getGalleryThumbnails(await getResponseDocument(t));for(const e of l)e.setAttribute("data-l2-id",o);await loadThumbnail(l,a)}function getGalleryThumbnails(e){const t=[],o=Array.from(e.querySelector(".thumbs").children);for(const e of o){const o=e.children[0],a=o.children[0];pushThumbnail(a,o,"loadL3",t)}return t}async function loadChapters(e){e.getAttribute("data-href")}',"script");t.appendChild(a);const l=e('let level2ScrollPosition,nextImageHref,breakLoop;async function loadL3(e){level2ScrollPosition=window.scrollY,window.scrollTo({top:0});const o=e.getAttribute("data-l2-id"),t=document.getElementById(o),n=e.getAttribute("data-href"),a="l3"+n,l=document.createElement("div");l.id=a,document.body.appendChild(l),t.className="hide",createGoToL2(t,l,"goToL2"),nextImageHref=n,breakLoop=!1,await loadL3Image(l)}function createGoToL2(e,o,t){const n=document.createElement("div");n.className="go-back",n.setAttribute("onclick",t+"(\'"+e.id+"\', \'"+o.id+"\')"),o.appendChild(n)}function goToL2(e,o){document.getElementById(e).className="show",document.getElementById(o).remove(),breakLoop=!0,window.scrollTo({top:level2ScrollPosition})}async function loadL3Image(e){if(""!==nextImageHref&&!breakLoop){const o=await getResponseDocument(nextImageHref),t=o.getElementById("image-container").children[0].children[0],n=new Image;n.src=t.src,e.appendChild(n);const a=o.querySelector(".next");nextImageHref=null===a?"":a.href,n.onload=async()=>{await loadL3Image(e)},n.onerror=async()=>{await onImageLoadError(n)}}}',"script");t.appendChild(l);const i=e('let nextSearchResultsHref,originalHref;const L1_CONTAINER_ID="l1-container",TOKYOMOTION="tokyomotion",KISSJAV="kissjav",NHENTAI="nhentai",ASURASCANS="asurascans";function setNextSearchResultsHref(e){let t=null;originalHref.includes(TOKYOMOTION)?t=e.querySelector(".prevnext"):originalHref.includes(KISSJAV)?t=e.querySelector(".pagination-next"):originalHref.includes(NHENTAI)&&(t=e.querySelector(".next")),nextSearchResultsHref=null===t?"":t.href}function getSearchResultsThumbnails(e){const t=[],n=[];if(originalHref.includes(TOKYOMOTION)){const t=e.querySelectorAll(".thumb-popu");n.splice(0,0,...Array.from(t))}else if(originalHref.includes(KISSJAV)){const t=e.querySelector(".videos").children;n.splice(0,0,...Array.from(t))}else if(originalHref.includes(NHENTAI)){const t=e.querySelector(".index-container").children;n.splice(0,0,...Array.from(t))}for(const e of n){let n,r;if(originalHref.includes(TOKYOMOTION))n=e,r=n.children[0].children[0];else if(originalHref.includes(KISSJAV)){if(n=e.children[0].children[0].children[0].children[0],r=n?.children[0],void 0===r)continue}else originalHref.includes(NHENTAI)&&(n=e.children[0],r=n.children[0]);pushThumbnail(r,n,"loadL2",t)}return t}function pushThumbnail(e,t,n,r){null!==e.getAttribute("data-src")&&(e.src=e.getAttribute("data-src"));const i=new Image;i.setAttribute("data-href",t.href),i.setAttribute("onclick",n+"(this)"),i.setAttribute("data-src",e.src),r.push(i)}async function getResponseDocument(e){const t=await getResponse(e),n=await t.text();return(new DOMParser).parseFromString(n,"text/html")}async function getResponse(e){const t=await fetch(e);return 200===t.status?t:(await waitFor(5e3),await getResponse(e))}async function waitFor(e){await new Promise((t=>setTimeout(t,e)))}async function onImageLoadError(e){await waitFor(5e3);let t=e.src;const n=t.indexOf("?time="),r="?time="+Date.now();-1!==n?t=t.substring(0,n)+r:t+=r,e.src=t}async function loadThumbnail(e,t,n=0){if(n<e.length){const r=e[n];t.appendChild(r),r.src=r.getAttribute("data-src"),r.onload=async()=>{await loadThumbnail(e,t,++n)}}else n===e.length&&"l1-container"===t.id&&createLoadMoreButton(t)}function createLoadMoreButton(e){const t=document.createElement("button");t.className="load-more",t.innerText="Load More",e.appendChild(t),t.onclick=async()=>{t.remove(),await loadL1()}}(async()=>{originalHref=location.href,setNextSearchResultsHref(document);let e=getSearchResultsThumbnails(document);const t=document.querySelectorAll(".content-enhancer");document.body.parentElement.remove();const n=document.createElement("html"),r=document.createElement("body"),i=document.createElement("head");for(const e of t)i.appendChild(e);n.appendChild(i),n.appendChild(r),document.appendChild(n);const a=document.createElement("div");a.id="l1-container",r.appendChild(a),await loadThumbnail(e,a,0)})();',"script");t.appendChild(i)})();
